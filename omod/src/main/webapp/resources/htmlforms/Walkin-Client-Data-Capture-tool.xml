<htmlform formName="Walk-in ART Service" 
formDescription="Walk-in Client Data Capture Tool" 
formEncounterType="d18bd8f2-dfcd-11eb-ba80-0242ac130004" 
formUuid="aa858f72-0080-44a8-8bac-55bc275e1d10" 
formVersion="3.0" 
formAddMetadata="yes" 
formUILocation="patientDashboard.visitActions" 
formOrder="3" 
formIcon="icon-medkit" 
formShowIf="(visit.active || !visit.active) &amp;&amp; patient.person.dead==false &amp;&amp; (sessionLocation.uuid=='86863db4-6101-4ecf-9a86-5e716d6504e4' || sessionLocation.uuid=='7c231e1a-1db5-11ea-978f-2e728ce88125')" 
formDisplayStyle="Standard">

    <script type="text/javascript">

            if (jQuery) {
    
                jq(document).ready(function () {                    
    
                    disable_fields("other-regimen");                    
                    disable_fields("reason-for-visit-other")                    

                    jq("#art-regimen").change(function () {
                        if (jq(this).find("select").find(":selected").val() == "90002") {
                            enable_fields("other-regimen");
                        } else {
                            disable_fields("other-regimen");
                        }
                    });                 

                    jq("#reason-for-visit").change(function () {
                        if (jq(this).find("select").find(":selected").val() == "90002") {
                            enable_fields("reason-for-visit-other");
                        } else {
                            disable_fields("reason-for-visit-other");
                        }
                    });
    
                    beforeSubmit.push(function () {
                        var submitVal = true;

                        var submitValStage = [];
                        var submitValStageART = [];

                        if(getValue('telephone-number.value')==""){
                            jq().toastmessage('showErrorToast', "Telephone Number is required");
                        }
            
                        if(jq("#patientNumber").find("input:first").val()==""){
                            jq().toastmessage('showErrorToast', "Patient Clinic number missing");
                        }

                        if(getValue('reason-for-visit.value')==""){
                            jq().toastmessage('showErrorToast', "Reason for visit is required");
                        }
            
                        if(getValue('current-regimen.value')==""){
                            jq().toastmessage('showErrorToast', "Current Regimen is required");
                        }

                        if(getValue('parent-health-facility.value')==""){
                            jq().toastmessage('showErrorToast', "Parent Health Facility is required");
                        }

                        if(getValue('serial-number.value')==""){
                            jq().toastmessage('showErrorToast', "Serial Number is required");
                        }

                        if(getValue('pt-clinic-number.value')==""){
                            jq().toastmessage('showErrorToast', "PT Clinic Number is required");
                        }

                        if(getValue('tb-status.value')==""){
                            jq().toastmessage('showErrorToast', "The TB Status is required");
                        }

                        if(getValue('no-of-art-pills.value')==""){
                            jq().toastmessage('showErrorToast', "The Art Refill is required");
                        }

                        if (submitValStage.indexOf(false) != -1) {
                            submitVal = false;
                            jq().toastmessage('showErrorToast', "There are errors during the validation of the data on the form. Please correct them and submit again");
                        }

                        return submitVal;
                    });
                    
                   

                });
    
            }
    
        </script>

    <div>
        <div class="row">
            <div class="col-md-6">
                <h3>Walk-in ART Service</h3>
            </div>
            <div class="col-md-5"></div>
            <div class="col-md-1">
                <submit class="confirm mb-2" submitLabel="Save" submitStyle="customSubmit" />
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <div class="card">
                    <div class="card-body">

                        <div class="card">
                            <div class="card-header">
                                    Patient History
                                </div>

                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>
                                            <span class="required">*</span>
                                            Reason for Visit
                                        </label>
                                        <obs id="reason-for-visit" conceptId="160288" answerConceptIds="166455, 166456, 165043, 90002" answerLabels="Lockdown, Natural Disaster, Admission, OTHER SPECIFY" />
                                        <label>
                                            <span class="required">*</span>
                                            Current Regimen
                                        </label>
                                        <obs id="current-regimen" conceptId="90315" answerConceptIds="99015,99016,99005,99006,164979,99039,99040,164977,99041,99042,99007,99008,99044,99043,99282,99283,99046,99017,99018,99019,99045,99284,99285,99286,99884,99885,164978,99888,163017,99887,90002" answerLabels="d4T-3TC-NVP,d4T-3TC-EFV,AZT-3TC-NVP,AZT-3TC-EFV,AZT-3TC-DTG,TDF-3TC-NVP,TDF-3TC-EFV,TDF-3TC-DTG,TDF-FTC-NVP,TDF-FTC-EFV,ABC-ddI(250)-LPV/r,ABC-ddI(400)-LPV/r,TDF-3TC-LPV/r,TDF-FTC-LPV/r,ZDV-ddI(250)-LPV/r,ZDV-ddI(400)-LPV/r,AZT-3TC-LPV/r,ABC-ddI-LPV/r,ABC-ddI-NFV,ABC-ddI-SQV/r,ZDV-ddI-LPV/r,AZT-ABC-LPV/r,ABC-ddI-ATV/r,AZT-3TC-ATV/r,ABC-3TC-NVP,ABC-3TC-EFV,ABC-3TC-DTG,ABC-3TC-ATV/r,ABC-3TC-LPV/r,TDF-3TC-ATV/r,Other" />
                                        <label>
                                            <span class="required">*</span>
                                            Parent Health facility
                                        </label>
                                        <obs id="parent-health-facility" conceptId="166453" />
                                        <obs id="district-of-parent-health-facility" labelText="District of Parent Health Facility" conceptId="166454" />
                                        <label>
                                            <span class="required">*</span>
                                            Serial No
                                        </label>
                                        <obs id="serial-number" conceptId="1646" />
                                    </div>

                                    <div class="row">
                                        <div class="col-md-12">
                                            <obs id="reason-for-visit-other" labelText="Other Specify" conceptId="164975" />
                                            <obs id="other-regimen" labelText="Other Regimen" conceptId="99126" />
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>
                                            <span class="required">*</span>
                                            Telephone No
                                        </label>
                                        <obs id="telephone-number" conceptId="90266" />
                                        <label>
                                            <span class="required">*</span>
                                            PT Clinic No
                                        </label>
                                        <obs id="pt-clinic-number" conceptId="90264" />

                                        <obs id="eid-number" labelText="EID Number" conceptId="166453" />

                                        <obs id="client-category" conceptId="165169" labelText="Client Category" answerConceptIds="90315, 165132, 159674, 162198, 165125, 90041, 99601, 157351, 99087,165133, 159991, 165127, 166461, 166462, 166463" answerLabels="MW- Migrant Workers, AGYW- Adoloscent Girls and Young Women, FF- Fisher Folk, LDT- Long Distance Truck Drivers, UF- Uniformed Forces, Preg- Pregnant, BF- Breastfeeding, IDU- Injectable Drug User, HEI- HIV Exposed Infant, OKP- Other KPs, TB- TB/HIV Client, RF- Refugee, ART- General ART Client, NIDU- Non IDU, OPP- Other PPs" />
                                        <label>
                                                    Nin Number
                                                </label>
                                        <span id="nin-number">
                                            <patient field="identifier" identifierTypeId="e1731641-30ab-102d-86b0-7a5022ba4115" required="false" />
                                        </span>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                Clinical Assessment and Refill
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>Weight</label>
                                        <obs conceptId="5089" />
                                        <label>Blood Pressure</label>
                                        <div class="row ml-1">
                                            <obs conceptId="5085" id="bp_systolic" />
                                            <p class="left">
                                                /
                                            </p>
                                            <obs conceptId="5086" id="bp_diastolic" />
                                        </div>
                                        <label>Temperature (c)</label>
                                        <obs conceptId="CIEL:5088" id="temperature" />
                                        <label>
                                            <span class="required">*</span>
                                            TB Status
                                        </label>
                                        <obs id="tb-status" class="long-value-select" conceptId="90216" answerConceptIds="90079,90073, 165295, 165296, 165297, 165298, 165299,165300,90071" answerLabels="1 - No signs,2 - Presumptive, 3C - TB Diagnosed - Clinically diagnosed,  3G - TB Diagnosed - Gene Xpert, 3L - TB Diagnosed - TB LAM,3M - TB Diagnosed -TB Microscopy, 3X - TB Diagnosed - Chest Xray, 3O - TB Diagnosed - Others, 4 - Tb Rx" />
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-3">
                                        <label>TB Pills</label>
                                        <obs conceptId="166464" />
                                        <label>INH Status</label>
                                        <obs id="tpt-status" conceptId="165288" answerConceptIds="1090,90072,165307,90040,160035" answerLabels="H0-Never Initiated,H1-On INH,H2-Defaulted,H3-Taken off due to side effects,H4-Completed" />
                                        <label>INH Pills</label>
                                        <obs conceptId="160856" id="inh-pills" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-4">
                                        <label>Nutrition Status</label>
                                        <obs conceptId="165050" answerConceptIds="1115, 99271, 99272, 99273, 5277" answerLabels="N - Normal, MAM - Moderate Acute Malnutrition, SAM - Severe Acute Malnutrition,
                                            SAMO - Severe Acute Malnutrition with Oedema, O - Overweight/Obese" />
                                        <obs labelText="CTX Refill" id="160856" conceptId="160856" />
                                        <label>ART Regimen</label>
                                        <obs id="art-refill" conceptId="90315" />
                                        <label>
                                            <span class="required">*</span>
                                            ART Refill
                                        </label>
                                        <obs id="no-of-art-pills" conceptId="99038" />
                                    </div>
                                </div>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-header">
                                Follow-up after Emergency
                            </div>
                            <div class="card-body">
                                <div class="row">
                                    <div class="col-md-6">
                                        <label>Client Follow-up Done?</label>
                                        <obs id="patient-follow-up" conceptId="165113" answerConceptIds="1065,1066" answerLabels="Yes, No" style="radio" class="horizontal" />
                                        <label>Client Follow-up Status</label>
                                        <obs id="client-follow-status" conceptId="166460" answerConceptIds="166457, 166458, 166459" answerLabels="Active at parent facility, Active at temporary Facility, Not followed up" />
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</htmlform>